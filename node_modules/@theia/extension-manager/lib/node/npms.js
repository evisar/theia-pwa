"use strict";
/********************************************************************************
 * Copyright (C) 2017 TypeFox and others.
 *
 * This program and the accompanying materials are made available under the
 * terms of the Eclipse Public License v. 2.0 which is available at
 * http://www.eclipse.org/legal/epl-2.0.
 *
 * This Source Code may also be made available under the following Secondary
 * Licenses when the conditions for such availability set forth in the Eclipse
 * Public License v. 2.0 are satisfied: GNU General Public License, version 2
 * with the GNU Classpath Exception which is available at
 * https://www.gnu.org/software/classpath/license.html.
 *
 * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0
 ********************************************************************************/
Object.defineProperty(exports, "__esModule", { value: true });
var request = require("request");
function search(query, from, size) {
    return new Promise(function (resolve, reject) {
        var url = 'https://api.npms.io/v2/search?q=' + encodeURIComponent(query);
        if (from) {
            url += '&from=' + from;
        }
        if (size) {
            url += '&size=' + size;
        }
        request(url, function (error, response, body) {
            if (error) {
                reject(error);
                // tslint:disable-next-line:no-magic-numbers
            }
            else if (response.statusCode === 200) {
                var result = JSON.parse(body);
                resolve(result.results.map(function (v) { return v.package; }));
            }
            else {
                reject(new Error(response.statusCode + ": " + response.statusMessage + " for " + url));
            }
        });
    });
}
exports.search = search;
//# sourceMappingURL=npms.js.map